<link rel="import" href="../components/paper-toast/paper-toast.html">
<link rel="import" href="../components/paper-fab/paper-fab.html">
<link rel="import" href="../components/core-icons/core-icons.html">
<link rel="import" href="../components/core-icons/av-icons.html">
<link rel="import" href="../components/paper-input/paper-input.html">
<link rel="import" href="../components/core-ajax/core-ajax.html">
<link rel="import" href="../components/paper-input/paper-autogrow-textarea.html">
<link rel="import" href="../components/paper-shadow/paper-shadow.html">

<polymer-element name="setting-page">

    <template >
        <link rel="stylesheet" type="text/css" href="../stylesheets/style.css">
        <core-ajax contentType="application/json"
                   id="post"
                    url="/user"
                   class=""></core-ajax>



        <div id="newUserContainer" vertical layout >

            <div class="settingTitle">
                Create New User
                <paper-fab icon="check" id="paper_fab1" on-tap={{tappato}} ></paper-fab>
            </div>
            <div>
                <div class="settingFields" inline  horizontal >User Name</div>
                <paper-input label="User Name"  id="paper_input2"  value="{{username}}" floatingLabel   inline ></paper-input>
            </div>
            <div >
                <div class="settingFields" inline   horizontal >Password</div>
                <paper-input-decorator label="Password" floatingLabel  inline>
                    <input type="password" is="core-input" id="pass"  value="{{pass}}" >
                </paper-input-decorator>
            </div>
            <div >
                <div class="settingFields" inline horizontal>Confirm Password</div>
                <paper-input-decorator label=" Confirm Password" on-keyup="{{ciccio}}" floatingLabel  inline>
                    <input type="password" is="core-input" value="{{conf}}" id="conf" >
                </paper-input-decorator>
                <core-icon icon=""  id="verification" inline></core-icon>
            </div>
        </div>

        <paper-toast id="toast" class="capsule" style="padding-right: 60px; text-align: center"></paper-toast>

    </template>
    <script>
        Polymer("setting-page",{
                    ready : function(){
                        console.log("setting page ready");
                        document.querySelector("paper-tabs").selected = "3";

                    },
                    ciccio: function() {

                        if (this.pass == this.conf){
                            console.log("good");
                            this.$.verification.style.color  = "green";
                            this.$.verification.icon="check";
                        }else{
                            this.$.verification.style.color  = "red";
                            this.$.verification.icon="clear";
                        }
                    },
                    tappato: function(){
                        if (this.pass == this.conf && this.pass) {
                            console.log("ho tappato");
                            var ajax = this.$.post;
                            ajax.method = 'POST';
                            this.$.toast.text = "new user added";
                            ajax.body = '{"name":"'+this.username+'", "password":"'+this.pass+'"}';

                            ajax.go();
                        }else{
                            this.$.toast.text = "wrong parameters";
                        }
                        this.$.toast.show();
                    }

                }
        )
    </script>
</polymer-element>